{"remainingRequest":"F:\\wwwroot\\D2AdminICE\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\wwwroot\\D2AdminICE\\src\\pages\\Contents\\components\\TabTable\\TabTable.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\wwwroot\\D2AdminICE\\src\\pages\\Contents\\components\\TabTable\\TabTable.vue","mtime":1550558035914},{"path":"F:\\wwwroot\\D2AdminICE\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"F:\\wwwroot\\D2AdminICE\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\wwwroot\\D2AdminICE\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport BasicContainer from \"@vue-materials/basic-container\";\nimport DeleteBalloon from \"./components/DeleteBalloon\";\nimport EditDialog from \"./components/EditDialog\";\nimport AddDialog from \"../../components/AddDialog\";\nimport { mapActions } from \"vuex\";\nimport util from \"@/libs/util.js\";\n\nexport default {\n  components: {\n    BasicContainer,\n    DeleteBalloon,\n    EditDialog,\n    AddDialog\n  },\n  name: \"TabTable\",\n\n  data() {\n    return {\n      tabKey: \"all\",\n      dataSource: {\n        all: [],\n        inreview: [],\n        released: [],\n        rejected: []\n      },\n      loading: true,\n      pagination: {\n        currentPage: 1,\n        pageSize: 10,\n        total:100000,\n        layout: 'prev, pager, next, total'\n      },\n      tabs: [\n        { tab: \"全部\", key: \"all\" },\n        { tab: \"已发布\", key: \"inreview\" },\n        { tab: \"审核中\", key: \"released\" },\n        { tab: \"已拒绝\", key: \"rejected\" }\n      ],\n      columns: [\n        {\n          title: \"ID\",\n          dataIndex: \"id\",\n          key: \"id\",\n          width: 50,\n          fixed: true,\n        },\n        {\n          title: \"标题\",\n          dataIndex: \"title\",\n          key: \"title\",\n          width: 320,\n          fixed: true,\n        },\n        {\n          title: \"标签\",\n          dataIndex: \"tags\",\n          key: \"tags\"\n        },\n        {\n          title: \"作者\",\n          dataIndex: \"author\",\n          key: \"author\"\n        },\n        {\n          title: \"置顶\",\n          dataIndex: \"isTop\",\n          key: \"isTop\"\n        },\n        {\n          title: \"更新时间\",\n          dataIndex: \"lastModificationTime\",\n          key: \"lastModificationTime\",\n          width: 240,\n          sortable: true,\n          formatter: this.formatDate\n        }\n      ],\n      rowHandle: {\n        columnHeader: \"操作\",\n        edit: {\n          icon: \"el-icon-edit\",\n          text: \"编辑\",\n          type: \"primary\",\n          size: \"small\"\n        },\n        remove: {\n          icon: \"el-icon-delete\",\n          text: \"删除\",\n          type: \"danger\",\n          size: \"small\"\n        }\n      },\n      formTemplate: {\n        title: {\n          title: \"标题\",\n          component: {\n            name: \"el-input\",\n            span: 18\n          }\n        },\n        id: {\n          title: \"ID\",\n          component: {\n            name: \"el-input\",\n            span: 6,\n            disabled: true\n          }\n        },\n        subTitle: {\n          title: \"副标题\"\n        },\n        contents: {\n          title: \"内容\",\n          component: {\n            name: \"el-input\",\n            type: \"textarea\"\n          }\n        },\n        tags: {\n          title: \"标签\",\n          component: {\n            name: \"el-input\",\n            span: 12\n          }\n        },\n        author: {\n          title: \"作者\",\n          component: {\n            name: \"el-input\",\n            span: 12\n          }\n        },\n        isTop: {\n          title: \"置顶\",\n          component: {\n            name: \"el-switch\",\n            span: 6\n          }\n        },\n        isRec: {\n          title: \"推荐\",\n          component: {\n            name: \"el-switch\",\n            span: 6\n          }\n        },\n        isHot: {\n          title: \"热\",\n          component: {\n            name: \"el-switch\",\n            span: 6\n          }\n        }\n      },\n      formOptions: {\n        labelWidth: \"120px\",\n        labelPosition: \"right\",\n        saveLoading: false\n      }\n    };\n  },\n\n  created() {},\n  mounted() {\n    this.fetchData();\n  },\n  methods: {\n    ...mapActions(\"d2admin/Contents\", [\n      \"GetAll\",\n      \"Del\",\n      \"CreateOrUpdate\",\n      \"Get\"\n    ]),\n    handleClick(tab) {\n      console.log(tab);\n    },\n    handleRowRemove({ index, row }, done) {\n      this.Del({\n        id: row.id\n      }).then(res => {\n        console.log(res);\n        this.$message({\n          message: \"删除成功\",\n          type: \"success\"\n        });\n      });\n      done();\n    },\n    handleRowEdit(datas, done) {\n      console.log(datas.row);\n      this.Get({ id: datas.row.id }).then(async res => {\n        var model = res.result;\n        if (model != null) {\n          model.title = datas.row.title;\n          model.subTitle = datas.row.subTitle;\n          model.contents = datas.row.contents;\n          model.tags = datas.row.tags;\n          model.author = datas.row.author;\n          model.isTop = datas.row.isTop;\n          model.isRec = datas.row.isRec;\n          model.isHot = datas.row.isHot;\n          this.CreateOrUpdate(model)\n            .then(async res => {\n              if (res.success) {\n                this.$message.success(\"修改成功！\");\n                done();\n              } else {\n                console.log(\"err: \", res.error);\n              }\n            })\n            .catch(err => {\n              console.log(\"err: \", err);\n            });\n        }\n      });\n    },\n    formatDate(row, column, cellValue, index) {\n      var timestr = new Date(cellValue);\n      return util.Dtformat(\"yyyy-MM-dd hh:mm:ss\", timestr);\n    },\n    handleDialogCancel(done) {\n      this.$message({\n        message: \"取消保存\",\n        type: \"warning\"\n      });\n      done();\n    },\n    fetchData() {\n      this.loading = true;\n      this.GetAll({\n        SkipCount: (this.pagination.currentPage-1)*this.pagination.pageSize,\n        MaxResultCount: this.pagination.total\n      }).then(res => {\n        this.dataSource = res;\n        this.loading = false;\n      });\n    },\n    handleSelectionChange(selection) {\n      console.log(selection);\n    }\n  }\n};\n",{"version":3,"sources":["TabTable.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AA2BA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"TabTable.vue","sourceRoot":"src/pages/Contents/components/TabTable","sourcesContent":["<template>\n  <div class=\"tab-table\">\n    <basic-container>\n      <el-tabs v-model=\"tabKey\" @tab-click=\"handleClick\">\n        <el-tab-pane v-for=\"tab in tabs\" :label=\"tab.tab\" :name=\"tab.key\" :key=\"tab.key\">\n          <d2-crud\n            :columns=\"columns\"\n            :data=\"dataSource[tab.key]\"\n            :loading=\"loading\"\n            :pagination=\"pagination\"\n            :rowHandle=\"rowHandle\"\n            :form-template=\"formTemplate\"\n            :form-options=\"formOptions\"\n            selection-row\n            @selection-change=\"handleSelectionChange\"\n            @row-edit=\"handleRowEdit\"\n            @row-remove=\"handleRowRemove\"\n            @dialog-cancel=\"handleDialogCancel\"\n          >\n          </d2-crud>\n        </el-tab-pane>\n      </el-tabs>\n    </basic-container>\n  </div>\n</template>\n\n<script>\nimport BasicContainer from \"@vue-materials/basic-container\";\nimport DeleteBalloon from \"./components/DeleteBalloon\";\nimport EditDialog from \"./components/EditDialog\";\nimport AddDialog from \"../../components/AddDialog\";\nimport { mapActions } from \"vuex\";\nimport util from \"@/libs/util.js\";\n\nexport default {\n  components: {\n    BasicContainer,\n    DeleteBalloon,\n    EditDialog,\n    AddDialog\n  },\n  name: \"TabTable\",\n\n  data() {\n    return {\n      tabKey: \"all\",\n      dataSource: {\n        all: [],\n        inreview: [],\n        released: [],\n        rejected: []\n      },\n      loading: true,\n      pagination: {\n        currentPage: 1,\n        pageSize: 10,\n        total:100000,\n        layout: 'prev, pager, next, total'\n      },\n      tabs: [\n        { tab: \"全部\", key: \"all\" },\n        { tab: \"已发布\", key: \"inreview\" },\n        { tab: \"审核中\", key: \"released\" },\n        { tab: \"已拒绝\", key: \"rejected\" }\n      ],\n      columns: [\n        {\n          title: \"ID\",\n          dataIndex: \"id\",\n          key: \"id\",\n          width: 50,\n          fixed: true,\n        },\n        {\n          title: \"标题\",\n          dataIndex: \"title\",\n          key: \"title\",\n          width: 320,\n          fixed: true,\n        },\n        {\n          title: \"标签\",\n          dataIndex: \"tags\",\n          key: \"tags\"\n        },\n        {\n          title: \"作者\",\n          dataIndex: \"author\",\n          key: \"author\"\n        },\n        {\n          title: \"置顶\",\n          dataIndex: \"isTop\",\n          key: \"isTop\"\n        },\n        {\n          title: \"更新时间\",\n          dataIndex: \"lastModificationTime\",\n          key: \"lastModificationTime\",\n          width: 240,\n          sortable: true,\n          formatter: this.formatDate\n        }\n      ],\n      rowHandle: {\n        columnHeader: \"操作\",\n        edit: {\n          icon: \"el-icon-edit\",\n          text: \"编辑\",\n          type: \"primary\",\n          size: \"small\"\n        },\n        remove: {\n          icon: \"el-icon-delete\",\n          text: \"删除\",\n          type: \"danger\",\n          size: \"small\"\n        }\n      },\n      formTemplate: {\n        title: {\n          title: \"标题\",\n          component: {\n            name: \"el-input\",\n            span: 18\n          }\n        },\n        id: {\n          title: \"ID\",\n          component: {\n            name: \"el-input\",\n            span: 6,\n            disabled: true\n          }\n        },\n        subTitle: {\n          title: \"副标题\"\n        },\n        contents: {\n          title: \"内容\",\n          component: {\n            name: \"el-input\",\n            type: \"textarea\"\n          }\n        },\n        tags: {\n          title: \"标签\",\n          component: {\n            name: \"el-input\",\n            span: 12\n          }\n        },\n        author: {\n          title: \"作者\",\n          component: {\n            name: \"el-input\",\n            span: 12\n          }\n        },\n        isTop: {\n          title: \"置顶\",\n          component: {\n            name: \"el-switch\",\n            span: 6\n          }\n        },\n        isRec: {\n          title: \"推荐\",\n          component: {\n            name: \"el-switch\",\n            span: 6\n          }\n        },\n        isHot: {\n          title: \"热\",\n          component: {\n            name: \"el-switch\",\n            span: 6\n          }\n        }\n      },\n      formOptions: {\n        labelWidth: \"120px\",\n        labelPosition: \"right\",\n        saveLoading: false\n      }\n    };\n  },\n\n  created() {},\n  mounted() {\n    this.fetchData();\n  },\n  methods: {\n    ...mapActions(\"d2admin/Contents\", [\n      \"GetAll\",\n      \"Del\",\n      \"CreateOrUpdate\",\n      \"Get\"\n    ]),\n    handleClick(tab) {\n      console.log(tab);\n    },\n    handleRowRemove({ index, row }, done) {\n      this.Del({\n        id: row.id\n      }).then(res => {\n        console.log(res);\n        this.$message({\n          message: \"删除成功\",\n          type: \"success\"\n        });\n      });\n      done();\n    },\n    handleRowEdit(datas, done) {\n      console.log(datas.row);\n      this.Get({ id: datas.row.id }).then(async res => {\n        var model = res.result;\n        if (model != null) {\n          model.title = datas.row.title;\n          model.subTitle = datas.row.subTitle;\n          model.contents = datas.row.contents;\n          model.tags = datas.row.tags;\n          model.author = datas.row.author;\n          model.isTop = datas.row.isTop;\n          model.isRec = datas.row.isRec;\n          model.isHot = datas.row.isHot;\n          this.CreateOrUpdate(model)\n            .then(async res => {\n              if (res.success) {\n                this.$message.success(\"修改成功！\");\n                done();\n              } else {\n                console.log(\"err: \", res.error);\n              }\n            })\n            .catch(err => {\n              console.log(\"err: \", err);\n            });\n        }\n      });\n    },\n    formatDate(row, column, cellValue, index) {\n      var timestr = new Date(cellValue);\n      return util.Dtformat(\"yyyy-MM-dd hh:mm:ss\", timestr);\n    },\n    handleDialogCancel(done) {\n      this.$message({\n        message: \"取消保存\",\n        type: \"warning\"\n      });\n      done();\n    },\n    fetchData() {\n      this.loading = true;\n      this.GetAll({\n        SkipCount: (this.pagination.currentPage-1)*this.pagination.pageSize,\n        MaxResultCount: this.pagination.total\n      }).then(res => {\n        this.dataSource = res;\n        this.loading = false;\n      });\n    },\n    handleSelectionChange(selection) {\n      console.log(selection);\n    }\n  }\n};\n</script>\n\n<style>\n</style>\n"]}]}